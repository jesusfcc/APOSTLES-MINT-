module.exports=[72724,a=>{"use strict";var b=a.i(651311),c=a.i(624068),d=a.i(638181),e=a.i(968039),f=a.i(828961),g=a.i(13894),h=a.i(866408);let i=[{type:"tuple[]",name:"calls",components:[{type:"address",name:"target"},{type:"uint256",name:"value"},{type:"bytes",name:"data"}]}],j=[];var k=a.i(615526),l=a.i(662713),m=a.i(770529),n=a.i(317218),o=a.i(380167),p=a.i(344421),q=a.i(258826),r=a.i(863153),s=a.i(378950);async function t(a){let{client:b,chain:c,bundlerUrl:d}=a,e=d??(0,s.getDefaultBundlerUrl)(c),f=`delegation-contract:${e}`;return(0,p.withCache)(async()=>{let a=(0,n.getClientFetch)(b),c=await a(e,{useAuthToken:!0,body:(0,o.stringify)({id:1,jsonrpc:"2.0",method:"tw_getDelegationContract",params:[]}),headers:{"Content-Type":"application/json"},method:"POST"});if(!c.ok)throw Error(`Failed to fetch delegation contract: ${c.status} ${c.statusText}`);let d=await c.json();if(d.error)throw Error(`Delegation contract RPC error: ${JSON.stringify(d.error)}`);if(!d.result?.delegationContract)throw Error("Invalid response: missing delegationContract in result");return d.result.delegationContract},{cacheKey:f,cacheTime:864e5})}async function u(b){let{client:c,address:d,chain:e}=b,f=(0,k.getRpcClient)({chain:e,client:c});return await a.A(464260).then(({eth_getTransactionCount:a})=>a(f,{address:(0,m.getAddress)(d),blockTag:"pending"}))}async function v(a,b){let c=await (0,e.getBytecode)(a),d=c.length>0&&c.startsWith("0xef0100"),f=`0x${c.slice(8,48)}`;return d&&f.toLowerCase()===b.toLowerCase()}async function w(a){let b=a.timeoutMs||3e5,c=a.intervalMs||1e3,d=Date.now()+b;for(;Date.now()<d;){let b=await (0,r.getQueuedTransactionHash)({options:a.options,transactionId:a.transactionId});if(b.transactionHash)return b.transactionHash;await new Promise(a=>setTimeout(a,c))}throw Error(`Timeout waiting for transaction to be mined on chain ${a.options.chain.id} with transactionId: ${a.transactionId}`)}let x=[{type:"receive",stateMutability:"payable"},{type:"function",name:"createSessionWithSig",inputs:[{name:"sessionSpec",type:"tuple",internalType:"struct SessionLib.SessionSpec",components:[{name:"signer",type:"address",internalType:"address"},{name:"isWildcard",type:"bool",internalType:"bool"},{name:"expiresAt",type:"uint256",internalType:"uint256"},{name:"callPolicies",type:"tuple[]",internalType:"struct SessionLib.CallSpec[]",components:[{name:"target",type:"address",internalType:"address"},{name:"selector",type:"bytes4",internalType:"bytes4"},{name:"maxValuePerUse",type:"uint256",internalType:"uint256"},{name:"valueLimit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]},{name:"constraints",type:"tuple[]",internalType:"struct SessionLib.Constraint[]",components:[{name:"condition",type:"uint8",internalType:"enum SessionLib.Condition"},{name:"index",type:"uint64",internalType:"uint64"},{name:"refValue",type:"bytes32",internalType:"bytes32"},{name:"limit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]}]}]},{name:"transferPolicies",type:"tuple[]",internalType:"struct SessionLib.TransferSpec[]",components:[{name:"target",type:"address",internalType:"address"},{name:"maxValuePerUse",type:"uint256",internalType:"uint256"},{name:"valueLimit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]}]},{name:"uid",type:"bytes32",internalType:"bytes32"}]},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"execute",inputs:[{name:"calls",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]}],outputs:[],stateMutability:"payable"},{type:"function",name:"executeWithSig",inputs:[{name:"wrappedCalls",type:"tuple",internalType:"struct WrappedCalls",components:[{name:"calls",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"uid",type:"bytes32",internalType:"bytes32"}]},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"getCallPoliciesForSigner",inputs:[{name:"signer",type:"address",internalType:"address"}],outputs:[{name:"",type:"tuple[]",internalType:"struct SessionLib.CallSpec[]",components:[{name:"target",type:"address",internalType:"address"},{name:"selector",type:"bytes4",internalType:"bytes4"},{name:"maxValuePerUse",type:"uint256",internalType:"uint256"},{name:"valueLimit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]},{name:"constraints",type:"tuple[]",internalType:"struct SessionLib.Constraint[]",components:[{name:"condition",type:"uint8",internalType:"enum SessionLib.Condition"},{name:"index",type:"uint64",internalType:"uint64"},{name:"refValue",type:"bytes32",internalType:"bytes32"},{name:"limit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]}]}]}],stateMutability:"view"},{type:"function",name:"getSessionExpirationForSigner",inputs:[{name:"signer",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"getSessionStateForSigner",inputs:[{name:"signer",type:"address",internalType:"address"}],outputs:[{name:"",type:"tuple",internalType:"struct SessionLib.SessionState",components:[{name:"transferValue",type:"tuple[]",internalType:"struct SessionLib.LimitState[]",components:[{name:"remaining",type:"uint256",internalType:"uint256"},{name:"target",type:"address",internalType:"address"},{name:"selector",type:"bytes4",internalType:"bytes4"},{name:"index",type:"uint256",internalType:"uint256"}]},{name:"callValue",type:"tuple[]",internalType:"struct SessionLib.LimitState[]",components:[{name:"remaining",type:"uint256",internalType:"uint256"},{name:"target",type:"address",internalType:"address"},{name:"selector",type:"bytes4",internalType:"bytes4"},{name:"index",type:"uint256",internalType:"uint256"}]},{name:"callParams",type:"tuple[]",internalType:"struct SessionLib.LimitState[]",components:[{name:"remaining",type:"uint256",internalType:"uint256"},{name:"target",type:"address",internalType:"address"},{name:"selector",type:"bytes4",internalType:"bytes4"},{name:"index",type:"uint256",internalType:"uint256"}]}]}],stateMutability:"view"},{type:"function",name:"getTransferPoliciesForSigner",inputs:[{name:"signer",type:"address",internalType:"address"}],outputs:[{name:"",type:"tuple[]",internalType:"struct SessionLib.TransferSpec[]",components:[{name:"target",type:"address",internalType:"address"},{name:"maxValuePerUse",type:"uint256",internalType:"uint256"},{name:"valueLimit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]}]}],stateMutability:"view"},{type:"function",name:"isWildcardSigner",inputs:[{name:"signer",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"onERC1155BatchReceived",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"onERC1155Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"onERC721Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"supportsInterface",inputs:[{name:"interfaceId",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"event",name:"Executed",inputs:[{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"},{name:"data",type:"bytes",indexed:!1,internalType:"bytes"}],anonymous:!1},{type:"event",name:"SessionCreated",inputs:[{name:"signer",type:"address",indexed:!0,internalType:"address"},{name:"sessionSpec",type:"tuple",indexed:!1,internalType:"struct SessionLib.SessionSpec",components:[{name:"signer",type:"address",internalType:"address"},{name:"isWildcard",type:"bool",internalType:"bool"},{name:"expiresAt",type:"uint256",internalType:"uint256"},{name:"callPolicies",type:"tuple[]",internalType:"struct SessionLib.CallSpec[]",components:[{name:"target",type:"address",internalType:"address"},{name:"selector",type:"bytes4",internalType:"bytes4"},{name:"maxValuePerUse",type:"uint256",internalType:"uint256"},{name:"valueLimit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]},{name:"constraints",type:"tuple[]",internalType:"struct SessionLib.Constraint[]",components:[{name:"condition",type:"uint8",internalType:"enum SessionLib.Condition"},{name:"index",type:"uint64",internalType:"uint64"},{name:"refValue",type:"bytes32",internalType:"bytes32"},{name:"limit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]}]}]},{name:"transferPolicies",type:"tuple[]",internalType:"struct SessionLib.TransferSpec[]",components:[{name:"target",type:"address",internalType:"address"},{name:"maxValuePerUse",type:"uint256",internalType:"uint256"},{name:"valueLimit",type:"tuple",internalType:"struct SessionLib.UsageLimit",components:[{name:"limitType",type:"uint8",internalType:"enum SessionLib.LimitType"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint256",internalType:"uint256"}]}]},{name:"uid",type:"bytes32",internalType:"bytes32"}]}],anonymous:!1},{type:"event",name:"ValueReceived",inputs:[{name:"from",type:"address",indexed:!0,internalType:"address"},{name:"value",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AllowanceExceeded",inputs:[{name:"allowanceUsage",type:"uint256",internalType:"uint256"},{name:"limit",type:"uint256",internalType:"uint256"},{name:"period",type:"uint64",internalType:"uint64"}]},{type:"error",name:"CallPolicyViolated",inputs:[{name:"target",type:"address",internalType:"address"},{name:"selector",type:"bytes4",internalType:"bytes4"}]},{type:"error",name:"CallReverted",inputs:[]},{type:"error",name:"ConditionFailed",inputs:[{name:"param",type:"bytes32",internalType:"bytes32"},{name:"refValue",type:"bytes32",internalType:"bytes32"},{name:"condition",type:"uint8",internalType:"uint8"}]},{type:"error",name:"InvalidDataLength",inputs:[{name:"actualLength",type:"uint256",internalType:"uint256"},{name:"expectedLength",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSignature",inputs:[{name:"msgSender",type:"address",internalType:"address"},{name:"thisAddress",type:"address",internalType:"address"}]},{type:"error",name:"LifetimeUsageExceeded",inputs:[{name:"lifetimeUsage",type:"uint256",internalType:"uint256"},{name:"limit",type:"uint256",internalType:"uint256"}]},{type:"error",name:"MaxValueExceeded",inputs:[{name:"value",type:"uint256",internalType:"uint256"},{name:"maxValuePerUse",type:"uint256",internalType:"uint256"}]},{type:"error",name:"NoCallsToExecute",inputs:[]},{type:"error",name:"SessionExpired",inputs:[]},{type:"error",name:"SessionExpiresTooSoon",inputs:[]},{type:"error",name:"SessionZeroSigner",inputs:[]},{type:"error",name:"TransferPolicyViolated",inputs:[{name:"target",type:"address",internalType:"address"}]},{type:"error",name:"UIDAlreadyProcessed",inputs:[]}];function y(a){return"inApp"===a.id||"embedded"===a.id}async function z(a,b,d){if(b?.auth?.mode!=="popup"&&b?.auth?.mode!==void 0&&d.authenticateWithRedirect){let e=a.strategy;c.socialAuthOptions.includes(e)&&await d.authenticateWithRedirect(e,b?.auth?.mode,b?.auth?.redirectUrl)}return D({authAccount:(await d.connect(a)).user.account,client:a.client,createOptions:b,desiredChain:a.chain})}async function A(a,b,c){a.authResult&&c.loginWithAuthToken&&await c.loginWithAuthToken(a.authResult);let d=await C(c);if(!d)throw Error("Failed to authenticate user.");return D({authAccount:d.account,client:a.client,createOptions:b,desiredChain:a.chain})}async function B(b){let{connectSmartAccount:c}=await a.A(947239);return c({chain:b.chain,client:b.client,personalAccount:b.authAccount},b.smartAccountOptions)}async function C(a){let b=await a.getUser();if("Logged In, Wallet Initialized"===b.status)return b}async function D(c){let e,k,{createOptions:n,authAccount:o,desiredChain:p,client:s}=c,y=n&&"executionMode"in n?n.executionMode:void 0;if(y&&("EIP4337"===y.mode?e=y.smartAccount:"EIP7702"===y.mode&&(k=y)),n&&"smartAccount"in n&&n?.smartAccount&&(e=n.smartAccount),e){let[a,b]=await B({authAccount:o,chain:p,client:s,smartAccountOptions:e});return{account:a,adminAccount:o,chain:b}}if(k){if(!p)throw Error("Chain is required for EIP-7702 execution, pass a chain when connecting the inAppWallet.");return{account:(b=>{let{client:c,adminAccount:e,sponsorGas:k}=b,n=async a=>{var b;let n,o=a[0];if(!o)throw Error("No transactions provided");let p=(0,d.getCachedChain)(o.chainId),s=(0,f.getContract)({address:e.address,chain:p,client:c,abi:x}),y=o.authorizationList?.[0],z=await t({client:c,chain:p});if(y&&y.address?.toLowerCase()!==z.toLowerCase())throw Error(`Authorization address does not match expected delegation contract address. Expected ${z} but got ${y.address}`);if(!y&&!await v(s,z)){let a=o.nonce?BigInt(o.nonce):BigInt(await u({client:c,address:e.address,chain:p}));a+=k?0n:1n;let b=await e.signAuthorization?.({address:(0,m.getAddress)(z),chainId:o.chainId,nonce:a});if(!b)throw Error("Failed to sign authorization");y=b}if(k){let b={calls:a.map(a=>({data:a.data??"0x",target:(0,m.getAddress)(a.to??""),value:a.value??0n})),uid:(0,q.randomBytesHex)()},f=await e.signTypedData({domain:{chainId:o.chainId,name:"MinimalAccount",verifyingContract:s.address,version:"1"},message:b,primaryType:"WrappedCalls",types:{Call:[{name:"target",type:"address"},{name:"value",type:"uint256"},{name:"data",type:"bytes"}],WrappedCalls:[{name:"calls",type:"Call[]"},{name:"uid",type:"bytes32"}]}}),g=await (0,r.executeWithSignature)({authorization:y,eoaAddress:(0,m.getAddress)(e.address),options:{chain:(0,d.getCachedChain)(o.chainId),client:c},signature:f,wrappedCalls:b});return{transactionHash:await w({options:{chain:(0,d.getCachedChain)(o.chainId),client:c},transactionId:g.transactionId})}}let A=(b={calls:a.map(a=>({data:a.data??"0x",target:(0,m.getAddress)(a.to??""),value:a.value??0n})),contract:s,overrides:{authorizationList:y?[y]:void 0,value:a.reduce((a,b)=>a+(b.value??0n),0n)}},n=(0,h.once)(async()=>"asyncParams"in b?await b.asyncParams():b),(0,g.prepareContractCall)({contract:b.contract,method:["0x3f707e6b",i,j],params:async()=>[(await n()).calls],value:async()=>(await n()).overrides?.value,accessList:async()=>(await n()).overrides?.accessList,gas:async()=>(await n()).overrides?.gas,gasPrice:async()=>(await n()).overrides?.gasPrice,maxFeePerGas:async()=>(await n()).overrides?.maxFeePerGas,maxPriorityFeePerGas:async()=>(await n()).overrides?.maxPriorityFeePerGas,nonce:async()=>(await n()).overrides?.nonce,extraGas:async()=>(await n()).overrides?.extraGas,erc20Value:async()=>(await n()).overrides?.erc20Value,authorizationList:async()=>(await n()).overrides?.authorizationList})),B=await (0,l.toSerializableTransaction)({from:e.address,transaction:A});return e.sendTransaction(B)},o={address:e.address,sendBatchTransaction:async a=>n(a),sendTransaction:async a=>n([a]),signMessage:({message:a,originalMessage:b,chainId:c})=>e.signMessage({chainId:c,message:a,originalMessage:b}),signTypedData:a=>e.signTypedData(a),sendCalls:async b=>{let{inAppWalletSendCalls:c}=await a.A(824623),d=b.calls[0];if(!d)throw Error("No calls to send");let e=d.client,f=d.chain||b.chain,g=await c({account:o,calls:b.calls,chain:f});return{chain:f,client:e,id:g}},getCallsStatus:async b=>{let{inAppWalletGetCallsStatus:c}=await a.A(824623);return c(b)},getCapabilities:async a=>({[a.chainId??1]:{atomic:{status:"supported"},paymasterService:{supported:k??!1}}})};return o})({adminAccount:o,client:s,sponsorGas:k.sponsorGas}),adminAccount:o,chain:p}}return{account:o,chain:p||b.ethereum}}a.s(["autoConnectInAppWallet",()=>A,"connectInAppWallet",()=>z,"isInAppWallet",()=>y],72724)}];

//# sourceMappingURL=node_modules_thirdweb_dist_esm_wallets_in-app_core_wallet_index_47ce27c8.js.map