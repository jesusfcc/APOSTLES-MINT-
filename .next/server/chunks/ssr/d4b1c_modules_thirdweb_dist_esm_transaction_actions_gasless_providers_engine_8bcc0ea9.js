module.exports=[944801,a=>{"use strict";var b=a.i(828961),c=a.i(380167),d=a.i(63408),e=a.i(851536);async function f({account:a,serializableTransaction:c,transaction:e,gasless:f}){let i=(0,b.getContract)({address:f.relayerForwarderAddress,chain:e.chain,client:e.client}),j=await (0,d.readContract)({contract:i,method:"function getNonce(address) view returns (uint256)",params:[a.address]}),[k,l]=await (async()=>{if(!c.to)throw Error("engine transactions must have a 'to' address");if(!c.gas)throw Error("engine transactions must have a 'gas' value");if(!c.data)throw Error("engine transactions must have a 'data' value");if(f.experimentalChainlessSupport){let b={chainid:BigInt(e.chain.id),data:c.data,from:a.address,gas:c.gas,nonce:j,to:c.to,value:0n};return[await a.signTypedData({domain:{name:"GSNv2 Forwarder",verifyingContract:i.address,version:"0.0.1"},message:b,primaryType:"ForwardRequest",types:{ForwardRequest:h}}),b]}let b={data:c.data,from:a.address,gas:c.gas,nonce:j,to:c.to,value:0n};return[await a.signTypedData({domain:{chainId:e.chain.id,name:f.domainName??"GSNv2 Forwarder",verifyingContract:i.address,version:f.domainVersion??"0.0.1"},message:b,primaryType:"ForwardRequest",types:{ForwardRequest:g}}),b]})();return{message:l,messageType:"forward",signature:k}}let g=[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"},{name:"gas",type:"uint256"},{name:"nonce",type:"uint256"},{name:"data",type:"bytes"}],h=[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"},{name:"gas",type:"uint256"},{name:"nonce",type:"uint256"},{name:"data",type:"bytes"},{name:"chainid",type:"uint256"}];async function i(a){let{message:b,messageType:d,signature:e}=await f(a),g=await fetch(a.gasless.relayerUrl,{body:(0,c.stringify)({forwarderAddress:a.gasless.relayerForwarderAddress,request:b,signature:e,type:d}),headers:{"Content-Type":"application/json"},method:"POST"});if(!g.ok)throw Error(`Failed to send transaction: ${await g.text()}`);let h=await g.json();if(!h.result)throw Error(`Relay transaction failed: ${h.message}`);let i=h.result.queueId,k=Date.now()+6e4;for(;Date.now()<k;){let b=await j({options:a,queueId:i});if(b)return{chain:a.transaction.chain,client:a.transaction.client,transactionHash:b.transactionHash};await new Promise(a=>setTimeout(a,1e3))}throw Error("Failed to find relayed transaction after 60000ms")}async function j(a){let{options:b,queueId:c}=a,d=b.gasless.relayerUrl.split("/relayer/")[0],f=await fetch(`${d}/transaction/status/${c}`,{method:"GET"}),g=await f.json();if(!f.ok)return null;let h=g.result;if(!h)return null;switch(h.status){case"errored":throw Error(`Transaction errored with reason: ${h.errorMessage}`);case"cancelled":throw Error("Transaction execution cancelled.");case"mined":return await (0,e.waitForReceipt)({chain:b.transaction.chain,client:b.transaction.client,transactionHash:h.transactionHash});default:return null}}a.s(["prepareEngineTransaction",()=>f,"relayEngineTransaction",()=>i])}];

//# sourceMappingURL=d4b1c_modules_thirdweb_dist_esm_transaction_actions_gasless_providers_engine_8bcc0ea9.js.map