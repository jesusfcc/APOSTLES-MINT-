module.exports=[191154,a=>{"use strict";a.s(["connectSmartAccount",()=>aA,"disconnectSmartAccount",()=>aB,"getEntrypointFromFactory",()=>aF],936241);var b=a.i(871892),c=a.i(71932),d=a.i(638181),e=a.i(828961),f=a.i(63408);let g=[{name:"owner",type:"address"},{name:"spender",type:"address"}],h=[{type:"uint256"}];async function i(a){return(0,f.readContract)({contract:a.contract,method:["0xdd62ed3e",g,h],params:[a.owner,a.spender]})}var j=a.i(104163),k=a.i(13894),l=a.i(866408);let m=[{name:"spender",type:"address"},{name:"value",type:"uint256"}],n=[{type:"bool"}];var o=a.i(908281),p=a.i(672683);let q=[{name:"signer",type:"address"}],r=[{components:[{name:"signer",type:"address"},{name:"approvedTargets",type:"address[]"},{name:"nativeTokenLimitPerTransaction",type:"uint256"},{name:"startTimestamp",type:"uint128"},{name:"endTimestamp",type:"uint128"}],name:"permissions",type:"tuple"}];async function s(a){return(0,f.readContract)({contract:a.contract,method:["0xf15d424e",q,r],params:[a.signer]})}let t=[{components:[{name:"signer",type:"address"},{name:"isAdmin",type:"uint8"},{name:"approvedTargets",type:"address[]"},{name:"nativeTokenLimitPerTransaction",type:"uint256"},{name:"permissionStartTimestamp",type:"uint128"},{name:"permissionEndTimestamp",type:"uint128"},{name:"reqValidityStartTimestamp",type:"uint128"},{name:"reqValidityEndTimestamp",type:"uint128"},{name:"uid",type:"bytes32"}],name:"req",type:"tuple"},{name:"signature",type:"bytes"}],u=[];var v=a.i(413811);function w(){return new Date(Date.now()+31536e7)}function x(a){return(0,v.toBigInt)(Math.floor(a.getTime()/1e3))}var y=a.i(258826);let z=[{name:"signer",type:"address"},{name:"isAdmin",type:"uint8"},{name:"approvedTargets",type:"address[]"},{name:"nativeTokenLimitPerTransaction",type:"uint256"},{name:"permissionStartTimestamp",type:"uint128"},{name:"permissionEndTimestamp",type:"uint128"},{name:"reqValidityStartTimestamp",type:"uint128"},{name:"reqValidityEndTimestamp",type:"uint128"},{name:"uid",type:"bytes32"}];async function A(a){let{account:b,contract:c,req:d}=a,e=await b.signTypedData({domain:{chainId:c.chain.id,name:"Account",verifyingContract:c.address,version:"1"},message:d,primaryType:"SignerPermissionRequest",types:{SignerPermissionRequest:z}});return{req:d,signature:e}}async function B(a){let{target:b,permissions:c}=a;return{approvedTargets:"*"===c.approvedTargets?[o.ZERO_ADDRESS]:c.approvedTargets,isAdmin:0,nativeTokenLimitPerTransaction:(0,j.toWei)(c.nativeTokenLimitPerTransaction?.toString()||"0"),permissionEndTimestamp:x(c.permissionEndTimestamp||w()),permissionStartTimestamp:x(c.permissionStartTimestamp||new Date(0)),reqValidityEndTimestamp:x(w()),reqValidityStartTimestamp:0n,signer:b,uid:await (0,y.randomBytesHex)()}}async function C(a){var b,c;let{accountContract:d,sessionKeyAddress:e,newPermissions:f}=a;if(!await (0,p.isContractDeployed)(d))return!0;let g=await s({contract:d,signer:e});return!!(g.endTimestamp&&g.endTimestamp<Math.floor(Date.now()/1e3)||(b=g.approvedTargets,!("*"===(c=f.approvedTargets)&&1===b.length&&b[0]===o.ZERO_ADDRESS||"*"!==c&&c.map(a=>a.toLowerCase()).every(a=>b.map(a=>a.toLowerCase()).includes(a))))||(0,j.toWei)(f.nativeTokenLimitPerTransaction?.toString()??"0")>g.nativeTokenLimitPerTransaction)}var D=a.i(663600),E=a.i(662713),F=a.i(31077),G=a.i(770529),H=a.i(753868),I=a.i(48302),J=a.i(841997);let K=2n**96n-1n;var L=a.i(863153),M=a.i(119151),N=a.i(378950),O=a.i(774392),P=a.i(429664);let Q=[{name:"sender",type:"address"},{name:"key",type:"uint192"}],R=[{name:"nonce",type:"uint256"}];async function S(a){return(0,f.readContract)({contract:a.contract,method:["0x35567e1a",Q,R],params:[a.sender,a.key]})}let T=[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],U=[{type:"bytes32"}];async function V(a){return(0,f.readContract)({contract:a.contract,method:["0xa6193531",T,U],params:[a.userOp]})}let W=[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],X=[{type:"bytes32"}];async function Y(a){return(0,f.readContract)({contract:a.contract,method:["0x22cdde4c",W,X],params:[a.userOp]})}var Z=a.i(133847),$=a.i(427492),_=a.i(464352),aa=a.i(707014),ab=a.i(131059),ac=a.i(317218),ad=a.i(694801),ae=a.i(380167),af=a.i(695313),ag=a.i(221570),ah=a.i(713837);async function ai(a){let{userOp:b,paymasterOverride:c,client:d,chain:e,entrypointAddress:f}=a;if(c)return c(b);let g=f??N.ENTRYPOINT_ADDRESS_v0_6,h=(0,N.getDefaultBundlerUrl)(e),i={id:1,jsonrpc:"2.0",method:"pm_sponsorUserOperation",params:[(0,ah.hexlifyUserOp)(b),g]},j=(0,ac.getClientFetch)(d),k=await j(h,{body:(0,ae.stringify)(i),headers:{"Content-Type":"application/json"},method:"POST"});if(!k.ok){let a=await k.text()||k.statusText;throw Error(`Paymaster error: ${k.status} - ${a}`)}let l=await k.json();if(l.result)return"string"==typeof l.result?{paymasterAndData:l.result}:(l.result.reason&&console.warn(`Paymaster policy rejected this transaction with reason: ${l.result.reason} ${l.result.policyId?`(policyId: ${l.result.policyId})`:""}`),{callGasLimit:l.result.callGasLimit?(0,aa.hexToBigInt)(l.result.callGasLimit):void 0,paymaster:l.result.paymaster,paymasterAndData:l.result.paymasterAndData,paymasterData:l.result.paymasterData,paymasterPostOpGasLimit:l.result.paymasterPostOpGasLimit?(0,aa.hexToBigInt)(l.result.paymasterPostOpGasLimit):void 0,paymasterVerificationGasLimit:l.result.paymasterVerificationGasLimit?(0,aa.hexToBigInt)(l.result.paymasterVerificationGasLimit):void 0,preVerificationGas:l.result.preVerificationGas?(0,aa.hexToBigInt)(l.result.preVerificationGas):void 0,verificationGasLimit:l.result.verificationGasLimit?(0,aa.hexToBigInt)(l.result.verificationGasLimit):void 0});let m=l.error?.message||l.error||k.statusText||"unknown error";throw Error(`Paymaster error from ${h}: ${m}`)}let aj=new Set,ak=a=>`${a.chain.id}:${a.address}`,al=a=>{aj.add(ak(a))},am=a=>{aj.delete(ak(a))},an=a=>aj.has(ak(a));async function ao(a){let b=a.timeoutMs||12e4,c=a.intervalMs||1e3,d=Date.now()+b;for(;Date.now()<d;){let b=await (0,L.getUserOpReceipt)(a);if(b)return b;await new Promise(a=>setTimeout(a,c))}throw Error(`Timeout waiting for userOp to be mined on chain ${a.chain.id} with UserOp hash: ${a.userOpHash}`)}async function ap(a){let{transaction:b,accountContract:c,factoryContract:d,adminAddress:e,overrides:f,sponsorGas:g,waitForDeployment:h=!0,isDeployedOverride:i}=a,j=b.chain,k=b.client,l={bundlerUrl:f?.bundlerUrl,chain:j,client:k,entrypointAddress:f?.entrypointAddress},m=(0,N.getEntryPointVersion)(a.overrides?.entrypointAddress||N.ENTRYPOINT_ADDRESS_v0_6),[n,o,q,r,s]=await Promise.all(["boolean"==typeof i?i:(0,p.isContractDeployed)(c).then(a=>a||an(c)),(0,$.encode)(b),(0,I.resolvePromisedValue)(b.gas),aq({bundlerOptions:l,chain:j,client:k,executeTx:b}),aw({accountContract:c,chain:j,client:k,entrypointAddress:f?.entrypointAddress,getNonceOverride:f?.getAccountNonce})]),{maxFeePerGas:t,maxPriorityFeePerGas:u}=r;return"v0.7"===m?ar({accountContract:c,adminAddress:e,bundlerOptions:l,callData:o,callGasLimit:q,factoryContract:d,isDeployed:n,maxFeePerGas:t,maxPriorityFeePerGas:u,nonce:s,overrides:f,sponsorGas:g,waitForDeployment:h}):as({accountContract:c,adminAddress:e,bundlerOptions:l,callData:o,callGasLimit:q,factoryContract:d,isDeployed:n,maxFeePerGas:t,maxPriorityFeePerGas:u,nonce:s,overrides:f,sponsorGas:g,waitForDeployment:h})}async function aq(a){let{executeTx:b,bundlerOptions:c,chain:d,client:e}=a,{maxFeePerGas:f,maxPriorityFeePerGas:g}=b,h=c?.bundlerUrl??(0,N.getDefaultBundlerUrl)(d);if((0,ac.isThirdwebUrl)(h)){let a=await (0,L.getUserOpGasFees)({options:c});f=a.maxFeePerGas,g=a.maxPriorityFeePerGas}else{let[a,b]=await Promise.all([(0,I.resolvePromisedValue)(f),(0,I.resolvePromisedValue)(g)]);if(a&&b)f=a,g=b;else{let c=await (0,Z.getDefaultGasOverrides)(e,d);g=b??c.maxPriorityFeePerGas??0n,f=a??c.maxFeePerGas??0n}}return{maxFeePerGas:f,maxPriorityFeePerGas:g}}async function ar(a){let b,c,{bundlerOptions:d,isDeployed:e,factoryContract:f,accountContract:g,adminAddress:h,sponsorGas:i,overrides:j,nonce:k,callData:l,callGasLimit:m,maxFeePerGas:n,maxPriorityFeePerGas:o,waitForDeployment:p}=a,{chain:q,client:r}=d;e?(c="0x",p&&await ax(g)):(b=f.address,c=await (0,$.encode)((0,M.prepareCreateAccount)({accountSalt:j?.accountSalt,adminAddress:h,createAccountOverride:j?.createAccount,factoryContract:f})),p&&al(g));let s={callData:l,callGasLimit:m??0n,factory:b,factoryData:c,maxFeePerGas:n,maxPriorityFeePerGas:o,nonce:k,paymaster:void 0,paymasterData:"0x",paymasterPostOpGasLimit:0n,paymasterVerificationGasLimit:0n,preVerificationGas:0n,sender:g.address,signature:N.DUMMY_SIGNATURE,verificationGasLimit:0n};if(i){let a=await ai({chain:q,client:r,entrypointAddress:j?.entrypointAddress,paymasterOverride:j?.paymaster,userOp:s});if(a.paymaster&&a.paymasterData&&(s.paymaster=a.paymaster,s.paymasterData=a.paymasterData),a.callGasLimit&&a.verificationGasLimit&&a.preVerificationGas&&a.paymasterPostOpGasLimit&&a.paymasterVerificationGasLimit)s.callGasLimit=a.callGasLimit,s.verificationGasLimit=a.verificationGasLimit,s.preVerificationGas=a.preVerificationGas,s.paymasterPostOpGasLimit=a.paymasterPostOpGasLimit,s.paymasterVerificationGasLimit=a.paymasterVerificationGasLimit;else{let a=j?.tokenPaymaster?{[j.tokenPaymaster.tokenAddress]:{stateDiff:{[(0,ad.keccak256)((0,_.encodeAbiParameters)([{type:"address"},{type:"uint256"}],[g.address,j.tokenPaymaster.balanceStorageSlot]))]:(0,aa.toHex)(O.maxUint96,{size:32})}}}:void 0,b=await (0,L.estimateUserOpGas)({options:d,userOp:s},a);s.callGasLimit=b.callGasLimit,s.verificationGasLimit=b.verificationGasLimit,s.preVerificationGas=b.preVerificationGas,s.paymasterPostOpGasLimit=j?.tokenPaymaster?500000n:b.paymasterPostOpGasLimit||0n,s.paymasterVerificationGasLimit=b.paymasterVerificationGasLimit||0n;let c=await ai({chain:q,client:r,entrypointAddress:j?.entrypointAddress,paymasterOverride:j?.paymaster,userOp:s});c.paymaster&&c.paymasterData&&(s.paymaster=c.paymaster,s.paymasterData=c.paymasterData)}}else{let a=await (0,L.estimateUserOpGas)({options:d,userOp:s});s.callGasLimit=a.callGasLimit,s.verificationGasLimit=a.verificationGasLimit,s.preVerificationGas=a.preVerificationGas,s.paymasterPostOpGasLimit=a.paymasterPostOpGasLimit||0n,s.paymasterVerificationGasLimit=a.paymasterVerificationGasLimit||0n}return{...s,signature:"0x"}}async function as(a){let b,{bundlerOptions:c,isDeployed:d,factoryContract:e,accountContract:f,adminAddress:g,sponsorGas:h,overrides:i,nonce:j,callData:k,callGasLimit:l,maxFeePerGas:m,maxPriorityFeePerGas:n,waitForDeployment:o}=a,{chain:p,client:q}=c;d?(b="0x",o&&await ax(f)):(b=await av({accountSalt:i?.accountSalt,adminAddress:g,createAccountOverride:i?.createAccount,factoryContract:e}),o&&al(f));let r={callData:k,callGasLimit:l??0n,initCode:b,maxFeePerGas:m,maxPriorityFeePerGas:n,nonce:j,paymasterAndData:"0x",preVerificationGas:0n,sender:f.address,signature:N.DUMMY_SIGNATURE,verificationGasLimit:0n};if(h){let a=await ai({chain:p,client:q,entrypointAddress:i?.entrypointAddress,paymasterOverride:i?.paymaster,userOp:r}),b="paymasterAndData"in a?a.paymasterAndData:"0x";if(b&&"0x"!==b&&(r.paymasterAndData=b),a.callGasLimit&&a.verificationGasLimit&&a.preVerificationGas)r.callGasLimit=a.callGasLimit,r.verificationGasLimit=a.verificationGasLimit,r.preVerificationGas=a.preVerificationGas;else{let a=await (0,L.estimateUserOpGas)({options:c,userOp:r});if(r.callGasLimit=a.callGasLimit,r.verificationGasLimit=a.verificationGasLimit,r.preVerificationGas=a.preVerificationGas,b&&"0x"!==b){let a=await ai({chain:p,client:q,entrypointAddress:i?.entrypointAddress,paymasterOverride:i?.paymaster,userOp:r}),b="paymasterAndData"in a?a.paymasterAndData:"0x";b&&"0x"!==b&&(r.paymasterAndData=b)}}}else{let a=await (0,L.estimateUserOpGas)({options:c,userOp:r});r.callGasLimit=a.callGasLimit,r.verificationGasLimit=a.verificationGasLimit,r.preVerificationGas=a.preVerificationGas}return{...r,signature:"0x"}}async function at(a){let{userOp:b,chain:c,entrypointAddress:d,adminAccount:e}=a,f=await au({chain:c,client:a.client,entrypointAddress:d,userOp:b});if(e.signMessage){let a=await e.signMessage({chainId:c.id,message:{raw:(0,ab.hexToBytes)(f)},originalMessage:(0,ae.stringify)(b)});return{...b,signature:a}}throw Error("signMessage not implemented in signingAccount")}async function au(a){let b,{userOp:c,chain:d,entrypointAddress:f}=a;if("v0.7"===(0,N.getEntryPointVersion)(f||N.ENTRYPOINT_ADDRESS_v0_6)){let g={accountGasLimits:(0,P.concat)([(0,af.pad)((0,ag.toHex)(BigInt(c.verificationGasLimit)),{size:16}),(0,af.pad)((0,ag.toHex)(BigInt(c.callGasLimit)),{size:16})]),callData:c.callData,gasFees:(0,P.concat)([(0,af.pad)((0,ag.toHex)(BigInt(c.maxPriorityFeePerGas)),{size:16}),(0,af.pad)((0,ag.toHex)(BigInt(c.maxFeePerGas)),{size:16})]),initCode:c.factory?(0,P.concat)([c.factory,c.factoryData||"0x"]):"0x",nonce:BigInt(c.nonce),paymasterAndData:c.paymaster?(0,P.concat)([c.paymaster,(0,af.pad)((0,ag.toHex)(BigInt(c.paymasterVerificationGasLimit||0)),{size:16}),(0,af.pad)((0,ag.toHex)(BigInt(c.paymasterPostOpGasLimit||0)),{size:16}),c.paymasterData||"0x"]):"0x",preVerificationGas:BigInt(c.preVerificationGas),sender:c.sender,signature:c.signature};b=await Y({contract:(0,e.getContract)({address:f||N.ENTRYPOINT_ADDRESS_v0_7,chain:d,client:a.client}),userOp:g})}else b=await V({contract:(0,e.getContract)({address:f||N.ENTRYPOINT_ADDRESS_v0_6,chain:d,client:a.client}),userOp:c});return b}async function av(a){let{factoryContract:b,adminAddress:c,accountSalt:d,createAccountOverride:e}=a,f=(0,M.prepareCreateAccount)({accountSalt:d,adminAddress:c,createAccountOverride:e,factoryContract:b});return(0,P.concat)([b.address,await (0,$.encode)(f)])}async function aw(a){let{accountContract:b,chain:c,client:d,entrypointAddress:f,getNonceOverride:g}=a;return g?g(b):await S({contract:(0,e.getContract)({address:f||N.ENTRYPOINT_ADDRESS_v0_6,chain:c,client:d}),key:(0,ah.generateRandomUint192)(),sender:b.address})}async function ax(a){let b=Date.now();for(;an(a);){if(Date.now()-b>6e4)throw am(a),Error("Account deployment is taking too long (over 1 minute). Please try again.");await new Promise(a=>setTimeout(a,500))}}let ay=new WeakMap,az=new WeakMap;async function aA(b,f){let{personalAccount:g,client:h}=b;if(!g)throw Error("No personal account provided for smart account connection");let i=f.chain,j="gasless"in f?f.gasless:f.sponsorGas;if(await (0,H.isZkSyncChain)(i))return[function(b){let{creationOptions:e,connectionOptions:f,chain:g}=b,h={address:(0,G.getAddress)(f.personalAccount.address),onTransactionRequested:async a=>f.personalAccount.onTransactionRequested?.(a),async sendTransaction(a){let i={chain:(0,d.getCachedChain)(a.chainId),client:f.client,data:a.data,eip712:a.eip712,to:a.to??void 0,value:a.value??0n},j=await (0,F.populateEip712Transaction)({account:h,transaction:i});if(b.sponsorGas&&!j.paymaster){let a=await (0,L.getZkPaymasterData)({options:{bundlerUrl:e.overrides?.bundlerUrl,chain:g,client:f.client,entrypointAddress:e.overrides?.entrypointAddress},transaction:j});j={...j,...a}}let k=await (0,F.signEip712Transaction)({account:h,chainId:g.id,eip712Transaction:j}),l=await (0,L.broadcastZkTransaction)({options:{bundlerUrl:e.overrides?.bundlerUrl,chain:g,client:f.client,entrypointAddress:e.overrides?.entrypointAddress},signedTransaction:k,transaction:j});return(0,c.trackTransaction)({chainId:g.id,client:f.client,contractAddress:a.to??void 0,transactionHash:l.transactionHash,walletAddress:h.address,walletType:"smart"}),{chain:g,client:f.client,transactionHash:l.transactionHash}},signMessage:async({message:a})=>f.personalAccount.signMessage({message:a}),async signTypedData(a){let b=(0,J.parseTypedData)(a);return f.personalAccount.signTypedData(b)},sendCalls:async b=>{let{inAppWalletSendCalls:c}=await a.A(824623),d=b.calls[0];if(!d)throw Error("No calls to send");let e=d.client,f=d.chain||b.chain,g=await c({account:h,calls:b.calls,chain:f});return{chain:f,client:e,id:g}},getCallsStatus:async b=>{let{inAppWalletGetCallsStatus:c}=await a.A(824623);return c(b)},getCapabilities:async a=>({[a.chainId??1]:{atomic:{status:"unsupported"},paymasterService:{supported:b.sponsorGas??!1}}})};return h}({chain:i,connectionOptions:b,creationOptions:f,sponsorGas:j}),i];if(f.factoryAddress&&!f.overrides?.entrypointAddress){let a=await aF(f.factoryAddress,h,i);a&&(f.overrides={...f.overrides,entrypointAddress:a})}f.overrides?.tokenPaymaster&&!f.overrides?.entrypointAddress&&(f.overrides={...f.overrides,entrypointAddress:N.ENTRYPOINT_ADDRESS_v0_7});let m=f.factoryAddress??(0,N.getDefaultAccountFactory)(f.overrides?.entrypointAddress),n=(0,e.getContract)({address:m,chain:i,client:h}),o=await (0,M.predictAddress)({accountAddress:f.overrides?.accountAddress,accountSalt:f.overrides?.accountSalt,adminAddress:g.address,factoryContract:n,predictAddressOverride:f.overrides?.predictAddress}).then(a=>a).catch(a=>{throw Error(`Failed to get account address with factory contract ${n.address} on chain ID ${i.id}: ${a?.message||"unknown error"}`,{cause:a})}),p=(0,e.getContract)({address:o,chain:i,client:h}),q=await aC({...f,accountContract:p,chain:i,client:h,factoryContract:n,personalAccount:g,sponsorGas:j});if(ay.set(g,q),az.set(q,g),f.sessionKey&&await C({accountContract:p,newPermissions:f.sessionKey.permissions,sessionKeyAddress:f.sessionKey.address})){let a=function(a){var b;let c,{contract:d,sessionKeyAddress:e,account:f,permissions:g}=a;return b={async asyncParams(){let{req:a,signature:b}=await A({account:f,contract:d,req:await B({permissions:g,target:e})});return{req:a,signature:b}},contract:d},c=(0,l.once)(async()=>"asyncParams"in b?await b.asyncParams():b),(0,k.prepareContractCall)({accessList:async()=>(await c()).overrides?.accessList,authorizationList:async()=>(await c()).overrides?.authorizationList,contract:b.contract,erc20Value:async()=>(await c()).overrides?.erc20Value,extraGas:async()=>(await c()).overrides?.extraGas,gas:async()=>(await c()).overrides?.gas,gasPrice:async()=>(await c()).overrides?.gasPrice,maxFeePerGas:async()=>(await c()).overrides?.maxFeePerGas,maxPriorityFeePerGas:async()=>(await c()).overrides?.maxPriorityFeePerGas,method:["0x5892e236",t,u],nonce:async()=>(await c()).overrides?.nonce,params:async()=>{let a=await c();return[a.req,a.signature]},value:async()=>(await c()).overrides?.value})}({account:g,contract:p,permissions:f.sessionKey.permissions,sessionKeyAddress:f.sessionKey.address});await (0,D.sendTransaction)({account:q,transaction:a})}return[q,i]}async function aB(a){let b=az.get(a);b&&(ay.delete(b),az.delete(a))}async function aC(b){let f=b.overrides?.tokenPaymaster;if(f&&"v0.7"!==(0,N.getEntryPointVersion)(b.overrides?.entrypointAddress||N.ENTRYPOINT_ADDRESS_v0_6))throw Error("Token paymaster is only supported for entrypoint version v0.7");let g=b.sponsorGas,h=b.accountContract,i={address:(0,G.getAddress)(h.address),onTransactionRequested:async a=>b.personalAccount.onTransactionRequested?.(a),async sendBatchTransaction(a){let e=(0,M.prepareBatchExecute)({accountContract:h,executeBatchOverride:b.overrides?.executeBatch,transactions:a});if(0===a.length)throw Error("No transactions to send");let f=a[0];if(!f)throw Error("No transactions to send");let g=(0,d.getCachedChain)(f.chainId),i=await aE({executeTx:e,options:{...b,accountContract:h,chain:g}});return(0,c.trackTransaction)({chainId:g.id,client:b.client,contractAddress:a[0]?.to??void 0,transactionHash:i.transactionHash,walletAddress:b.accountContract.address,walletType:"smart"}),i},async sendTransaction(a){let g;if(f){await aD({accountContract:h,erc20Paymaster:f,options:b});let a=async()=>({paymaster:f.paymasterAddress,paymasterData:"0x"});g=b.overrides?.paymaster||a}else g=b.overrides?.paymaster;a.chainId!==h.chain.id&&(h=(0,e.getContract)({address:i.address,chain:(0,d.getCachedChain)(a.chainId),client:b.client}));let j=(0,M.prepareExecute)({accountContract:h,executeOverride:b.overrides?.execute,transaction:a}),k=(0,d.getCachedChain)(a.chainId),l=await aE({executeTx:j,options:{...b,accountContract:h,chain:k,overrides:{...b.overrides,paymaster:g}}});return(0,c.trackTransaction)({chainId:k.id,client:b.client,contractAddress:a.to??void 0,transactionHash:l.transactionHash,walletAddress:b.accountContract.address,walletType:"smart"}),l},async signMessage({message:c}){if(b.overrides?.signMessage)return b.overrides.signMessage({accountContract:h,adminAccount:b.personalAccount,factoryContract:b.factoryContract,message:c});let{smartAccountSignMessage:d}=await a.A(4671);return d({accountContract:h,factoryContract:b.factoryContract,message:c,options:b})},async signTypedData(c){if(b.overrides?.signTypedData)return b.overrides.signTypedData({accountContract:h,adminAccount:b.personalAccount,factoryContract:b.factoryContract,typedData:c});let{smartAccountSignTypedData:d}=await a.A(4671);return d({accountContract:h,factoryContract:b.factoryContract,options:b,typedData:c})},sendCalls:async b=>{let{inAppWalletSendCalls:c}=await a.A(824623),d=b.calls[0];if(!d)throw Error("No calls to send");let e=d.client,f=d.chain||b.chain,g=await c({account:i,calls:b.calls,chain:f});return{chain:f,client:e,id:g}},getCallsStatus:async b=>{let{inAppWalletGetCallsStatus:c}=await a.A(824623);return c(b)},getCapabilities:async a=>({[a.chainId??1]:{atomic:{status:"supported"},paymasterService:{supported:g??!1}}})};return i}async function aD(b){var c,d;let f,{accountContract:g,erc20Paymaster:h,options:o}=b,p=h.tokenAddress,q=(0,e.getContract)({address:p,chain:g.chain,client:g.client});if(await i({contract:q,owner:g.address,spender:h.paymasterAddress})>0n)return;let r=(d={asyncParams:async()=>{let b;if("amount"in c){let{decimals:d}=await a.A(301552),e=await d(c).catch(()=>18);b=(0,j.toUnits)(c.amount.toString(),e)}else b=c.amountWei;return{overrides:{erc20Value:{amountWei:b,tokenAddress:c.contract.address},...c.overrides},spender:c.spender,value:b}},contract:(c={amountWei:K-1n,contract:q,spender:h.paymasterAddress}).contract},f=(0,l.once)(async()=>"asyncParams"in d?await d.asyncParams():d),(0,k.prepareContractCall)({accessList:async()=>(await f()).overrides?.accessList,authorizationList:async()=>(await f()).overrides?.authorizationList,contract:d.contract,erc20Value:async()=>(await f()).overrides?.erc20Value,extraGas:async()=>(await f()).overrides?.extraGas,gas:async()=>(await f()).overrides?.gas,gasPrice:async()=>(await f()).overrides?.gasPrice,maxFeePerGas:async()=>(await f()).overrides?.maxFeePerGas,maxPriorityFeePerGas:async()=>(await f()).overrides?.maxPriorityFeePerGas,method:["0x095ea7b3",m,n],nonce:async()=>(await f()).overrides?.nonce,params:async()=>{let a=await f();return[a.spender,a.value]},value:async()=>(await f()).overrides?.value})),s=await (0,E.toSerializableTransaction)({from:g.address,transaction:r}),t=(0,M.prepareExecute)({accountContract:g,executeOverride:o.overrides?.execute,transaction:s});await aE({executeTx:t,options:{...o,overrides:{...o.overrides,tokenPaymaster:void 0}}})}async function aE(a){let{executeTx:d,options:e}=a;try{let a=await ap({accountContract:e.accountContract,adminAddress:e.personalAccount.address,factoryContract:e.factoryContract,overrides:e.overrides,sponsorGas:e.sponsorGas,transaction:d}),b=await at({adminAccount:e.personalAccount,chain:e.chain,client:e.client,entrypointAddress:e.overrides?.entrypointAddress,userOp:a}),f={bundlerUrl:e.overrides?.bundlerUrl,chain:e.chain,client:e.client,entrypointAddress:e.overrides?.entrypointAddress},g=await (0,L.bundleUserOp)({options:f,userOp:b}),h=await ao({...f,userOpHash:g});return(0,c.trackTransaction)({chainId:e.chain.id,client:e.client,contractAddress:await (0,I.resolvePromisedValue)(d.to??void 0),transactionHash:h.transactionHash,walletAddress:e.accountContract.address,walletType:"smart"}),{chain:e.chain,client:e.client,transactionHash:h.transactionHash}}catch(a){throw(0,b.isInsufficientFundsError)(a)&&(0,c.trackInsufficientFundsError)({chainId:e.chain.id,client:e.client,contractAddress:await (0,I.resolvePromisedValue)(d.to??void 0),error:a,transactionValue:await (0,I.resolvePromisedValue)(d.value),walletAddress:e.accountContract.address}),a}finally{am(e.accountContract)}}async function aF(a,b,c){let d=(0,e.getContract)({address:a,chain:c,client:b});try{return await (0,f.readContract)({contract:d,method:"function entrypoint() public view returns (address)"})}catch{return}}a.i(936241);var aG=a.i(608140);a.s(["connectSmartAccount",()=>aA,"disconnectSmartAccount",()=>aB,"getEntrypointFromFactory",()=>aF,"isSmartWallet",()=>aG.isSmartWallet],191154)}];

//# sourceMappingURL=node_modules_thirdweb_dist_esm_wallets_smart_index_250bec9d.js.map